<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yohn's TikTok Live Chat Analytics Demo Beta 1</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üëª</text></svg>">
    <meta name="description" content="A chat reader for TikTok LIVE. This demo project uses the unofficial TikTok API to retrieve chat comments, gifts and other events from TikTok LIVE.">
    <meta name="keywords" content="TikTok,Live,Livestream,Chat,Reader,Scraper,Tracker,tiktok.com,broadcast,api,library,javascript">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="connection.js"></script>
    <script src="app.js"></script>

    <script>
        function generateOverlay() {
            let username = $('#uniqueIdInput').val();
            let url = `/obs.html?username=${username}&showLikes=1&showChats=1&showGifts=1&showFollows=1&showJoins=1&bgColor=rgb(24,23,28)&fontColor=rgb(227,229,235)&fontSize=1.3em`;

            if(username) {
                window.open(url, '_blank');
            } else {
                alert("Enter username");
            }
        }
    </script>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12 col-md-10">
            <h1>TikTok LIVE Chat Reader</h1>
            <p class="m-0">Best to use on a desktop / laptop PC, and the mobile might be slower to load. This is the second beta version for the public that has been published. There will be more updates to come soon.</p>
            <p class="m-0">This service does cost me $$ to run, and I will not know for sure how much until the end of the month.</p>
            <p class="m-0">The estimates so far is $10-20 for the server resources, but will probably increase the more we use this. Any little bit will help keep this project going.
            </p>
            <p clas="m-0">This is a modified version from: <a href="https://github.com/zerodytrash/TikTok-Chat-Reader">zerodytrash/TikTok-Chat-Reader</a></p>
            <p class="m-0 lead">CashApp: $yohnjohn84&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Venmo: @John-BrittainIII</p>
            <p class="m-0 lead"><u>After you start your live</u>, type in your @username (without the @) on TikTok in the box below.</p>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-6 mb-3">
            <div class="input-group mb-3">
                <button type="button" class="btn btn-primary"
                data-bs-toggle="modal" data-bs-target="#userSettings" id="userCog">
                    <span class="switch-toggle">‚öôÔ∏è</span>
                    <span class="switch-toggle d-none spinner-border spinner-border-sm" aria-hidden="true"></span>
                    <span class="visually-hidden" role="status">Loading...</span>
                </button>
                <ul class="dropdown-menu" id="settingLoginLi">
                    <li>
                        <div class="px-4 py-3">
                            <div class="mb-3">
                                <label for="userEmail" class="form-label">Email address</label>
                                <input type="email" class="form-control" id="userEmail" name="userEmail" placeholder="email@example.com">
                            </div>
                            <div class="mb-3">
                                <label for="userPassword" class="form-label">Password</label>
                                <input type="password" class="form-control" id="userPassword" name="userPassword" placeholder="Password">
                            </div>
                            <button type="button" class="btn btn-primary" id="userLogin">Sign in</button>
                        </div>
                    </li>
                    <li class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="#" id="userSignUpLink">New around here? Sign up</a></li>
                </ul>
                <span class="input-group-text">@</span>
                <div class="form-floating">
                    <input type="text" class="form-control" id="uniqueIdInput" list="datalistOptions" placeholder="username">
                    <label for="floatingInputGroup1">Username</label>
                </div>
                <datalist id="datalistOptions">
                </datalist>

                <div class="input-group-text coming-soon">
                    <input id="cont" class="form-check-input mt-0" type="checkbox" value="1" aria-label="Checkbox for checking when they come back online">
                    <label for="cont" class="coming-soon" title="Coming Soon">&nbsp;&nbsp;Reconnect when online again?</label>
                </div>

                <input type="button" id="connectButton" value="connect" class="btn btn-outline-secondary">
            </div>
            <div class="card text-bg-dark mb-3">
                <div id="battleParties" class="card-body"></div>
            </div>
        </div>
        <div class="col-sm-6 text-center mb-3">
            <div class="d-flex justify-content-center mb-3">
                <span id="HostInfo" class="input-group-text"></span>
            </div>
            <div class="d-flex justify-content-center mb-3">
                <span id="stateText" class="input-group-text"></span>
            </div>
            <div class="d-flex justify-content-center">
                <table id="top_fans"></table>
            </div>
        </div>

        <div class="w-100"></div>
        <div class="col-sm-6 text-end">
            <div id="roomStats">
                <div class="input-group mb-3">
                    <span class="input-group-text text-light" id="stats-viewers"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd"><path d="M1.981 8.444h20.038c.398 0 .747.264.856.648l1.105 3.904.02.139c0 .209-.127.402-.33.48l-.001.001c-.24.092-.511-.005-.635-.231l-1.144-2.071-.328 7.967c-.017.403-.347.719-.749.719h-.001c-.393 0-.716-.306-.746-.698-.068-.865-.249-2.933-.304-3.752-.022-.34-.271-.54-.541-.54-.242 0-.514.2-.537.54-.055.819-.236 2.887-.304 3.752-.03.392-.352.698-.746.698h-.001c-.402 0-.732-.316-.749-.719-.086-2.08-.435-8.736-.435-8.736h-1.669s-.349 6.656-.435 8.736c-.017.402-.347.719-.749.719h-.001c-.394 0-.716-.306-.746-.698-.068-.865-.249-2.933-.304-3.752-.023-.34-.295-.54-.537-.54h-.004c-.242 0-.515.2-.537.54-.055.819-.236 2.887-.304 3.752-.03.392-.353.698-.746.698h-.001c-.402 0-.732-.316-.749-.719-.086-2.08-.435-8.736-.435-8.736h-1.681s-.349 6.656-.435 8.736c-.017.403-.347.719-.749.719h-.001c-.394 0-.716-.306-.746-.698-.068-.865-.249-2.933-.304-3.752-.023-.34-.295-.54-.537-.54-.27 0-.519.2-.541.54-.055.819-.236 2.887-.304 3.752-.03.392-.353.698-.746.698h-.001c-.402 0-.732-.316-.749-.719l-.328-7.967-1.144 2.071c-.124.226-.395.323-.635.231l-.001-.001c-.203-.078-.33-.271-.33-.48l.02-.139 1.105-3.904c.109-.384.458-.648.856-.648zm3.019-4.444c1.104 0 2 .896 2 2s-.896 2-2 2-2-.896-2-2 .896-2 2-2zm14 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-6.994 0c1.104 0 2 .896 2 2s-.896 2-2 2-2-.896-2-2 .896-2 2-2z"/></svg></span>
                    <input readonly id="viewerCountStats" value="TBD" type="text" class="form-control " placeholder="0" aria-label="Viewers" aria-describedby="stats-viewers">
                    <span class="input-group-text text-light" id="stats-likes"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M4.021 10.688c1.208.172 2.51 1.312 2.979 1.781v-10.514c0-1.08.92-1.955 2-1.955s2 .875 2 1.955v6.058c0 .784.814.885.919.103.216-1.604 2.519-1.817 2.693.399.043.546.726.655.866.027.326-1.444 2.501-1.458 2.758.758.066.579.796.696.848.034.051-.67.281-.934.607-.934 1.098 0 2.309 2.019 2.309 4.41 0 4.295-3 4.306-3 11.19h-10c-.332-3.942-3.462-7.431-6.271-10.241-.488-.488-.729-1.052-.729-1.564 0-.93.759-1.688 2.021-1.507z"/></svg></span>
                    <input readonly id="likeCountStats" value="TBD" type="text" class="form-control" placeholder="0" aria-label="Likes" aria-describedby="stats-likes">
                    <span class="input-group-text text-light" id="stats-viewers"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M18 1h-11.916l-6.084 7 12 15 12-14.917-6-7.083zm-3.387 8l-2.613 7.839-2.613-7.839h5.226zm-4.588-2l1.969-2.412 1.94 2.412h-3.909zm5.612-1.073l-2.354-2.927h3.33l-.976 2.927zm-7.286-.037l-.964-2.89h3.322l-2.358 2.89zm-1.738 1.11h-3.094l2.236-2.573.858 2.573zm.666 2l2.8 8.397-6.718-8.397h3.918zm9.442 0h3.975l-6.787 8.437 2.812-8.437zm.666-2l.868-2.604 2.206 2.604h-3.074z"/></svg></span>
                    <input readonly id="diamondsCountStats" value="TBD" type="text" class="form-control" placeholder="0" aria-label="Diamonds" aria-describedby="stats-diamonds">
                    <button type="button" class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
                        <span class="visually-hidden">Toggle Dropdown</span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><h4 class="dropdown-title">Top 3 Gifters</h4></li>
                        <li id="topGiftersDivider"><p class="p3">Since the start of host's live till you connected.</p></li>
                    </ul>
                </div>
            </div>
            <div id="battleStats" class="hide"></div>
        </div>
        <div class="col-sm-6">
            <div id="topViewers"></div>
        </div>
    </div>

    <div class="row">
        <div class="col-12 col-sm-6 col-md-4 mb-3">
            <div class="card">
                <h5 class="card-header">
                    Chats
                </h5>
                <ul class="list-group list-group-flush chatcontainer" id="chatcontainer"></ul>
            </div>
        </div>
        <div class="col-12 col-sm-6 col-md-4">
            <div class="card mb-3">
                <h5 class="card-header">
                    Gifts
                    <button
                        type="button"
                        class="btn btn-outline-primary"
                        id="ch">
                        Button
                    </button>

                    <span class="float-end" style="cursor: pointer;">
                        <svg id="s-on" fill="#0d6efd" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M6 7l8-5v20l-8-5v-10zm-6 10h4v-10h-4v10zm20.264-13.264l-1.497 1.497c1.847 1.783 2.983 4.157 2.983 6.767 0 2.61-1.135 4.984-2.983 6.766l1.498 1.498c2.305-2.153 3.735-5.055 3.735-8.264s-1.43-6.11-3.736-8.264zm-.489 8.264c0-2.084-.915-3.967-2.384-5.391l-1.503 1.503c1.011 1.049 1.637 2.401 1.637 3.888 0 1.488-.623 2.841-1.634 3.891l1.503 1.503c1.468-1.424 2.381-3.309 2.381-5.394z"/></svg>
                        <svg id="s-off" fill="#6c757d" class="d-none" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 7.358v15.642l-8-5v-.785l8-9.857zm3-6.094l-1.548-1.264-3.446 4.247-6.006 3.753v3.646l-2 2.464v-6.11h-4v10h.843l-3.843 4.736 1.548 1.264 18.452-22.736z"/></svg>
                        &nbsp;&nbsp;&nbsp;
                        <svg id="g-on" fill="#0d6efd" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M11 24h-10v-12h10v12zm0-18h-11v4h11v-4zm2 18h10v-12h-10v12zm0-18v4h11v-4h-11zm4.369-6c-2.947 0-4.671 3.478-5.369 5h5.345c3.493 0 3.53-5 .024-5zm-.796 3.621h-2.043c.739-1.121 1.438-1.966 2.342-1.966 1.172 0 1.228 1.966-.299 1.966zm-9.918 1.379h5.345c-.698-1.522-2.422-5-5.369-5-3.506 0-3.469 5 .024 5zm.473-3.345c.903 0 1.603.845 2.342 1.966h-2.043c-1.527 0-1.471-1.966-.299-1.966z"/></svg>
                        <svg id="g-off" fill="#6c757d" class="d-none" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M17.369 0c-2.947 0-4.671 3.478-5.369 5h5.345c3.493 0 3.53-5 .024-5zm-.796 3.621h-2.043c.739-1.121 1.438-1.966 2.342-1.966 1.172 0 1.228 1.966-.299 1.966zm-9.918 1.379h5.345c-.698-1.522-2.422-5-5.369-5-3.506 0-3.469 5 .024 5zm.473-3.345c.903 0 1.603.845 2.342 1.966h-2.043c-1.527 0-1.471-1.966-.299-1.966zm16.872 4.345h-24v6h1.056v12h21.889v-12h1.055v-6zm-13 16h-8v-10h8v10zm0-12h-9v-2h9v2zm2-2h9v2h-9v-2zm8 14h-8v-10h8v10z"/></svg>
                    </span>
                </h5>
                <ul class="list-group list-group-flush giftcontainer" id="giftcontainer"></ul>
            </div>
        </div>
        <div class="col-12 col-sm-6 col-md-4 offset-sm-3 offset-md-0">
            <div class="card mb-3">
                <div class="card-header">
                    <ul class="nav nav-tabs card-header-tabs" id="social-lists" role="tablist">
                        <li class="nav-item">
                            <button class="nav-link active" id="all-tab" data-bs-toggle="tab" data-bs-target="#all-tab-pane" type="button" role="tab" aria-controls="all-tab-pane" aria-selected="true">All</button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" id="likes-tab" data-bs-toggle="tab" data-bs-target="#likes-tab-pane" type="button" role="tab" aria-controls="likes-tab-pane" aria-selected="false">Likes</button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" id="joins-tab" data-bs-toggle="tab" data-bs-target="#joins-tab-pane" type="button" role="tab" aria-controls="joins-tab-pane" aria-selected="false">Joins</button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" id="excel-tab" data-bs-toggle="tab" data-bs-target="#shares-tab-pane" type="button" role="tab" aria-controls="shares-tab-pane" aria-selected="false">Shares</button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" id="excel-tab" data-bs-toggle="tab" data-bs-target="#follows-tab-pane" type="button" role="tab" aria-controls="follows-tab-pane" aria-selected="false">Follows</button>
                        </li>
                    </ul>
                </div>
                <div class="tab-content overflow-auto" id="myTabContent2" style="max-height:30vh;height:30vh;">
                    <div class="tab-pane fade show active" id="all-tab-pane" role="tabpanel" aria-labelledby="all-tab" tabindex="0">
                        <ul class="list-group list-group-flush alltotalcontainer" id="alltotalcontainer"></ul>
                    </div>
                    <div class="tab-pane fade" id="likes-tab-pane" role="tabpanel" aria-labelledby="excel-tab" tabindex="0">
                        <ul class="list-group list-group-flush likestotalcontainer" id="likestotalcontainer"></ul>
                    </div>
                    <div class="tab-pane fade" id="joins-tab-pane" role="tabpanel" aria-labelledby="joins-tab" tabindex="0">
                        <ul class="list-group list-group-flush joinstotalcontainer" id="joinstotalcontainer"></ul>
                    </div>
                    <div class="tab-pane fade" id="shares-tab-pane" role="tabpanel" aria-labelledby="shares-tab" tabindex="0">
                        <ul class="list-group list-group-flush sharestotalcontainer" id="sharestotalcontainer"></ul>
                    </div>
                    <div class="tab-pane fade" id="follows-tab-pane" role="tabpanel" aria-labelledby="follows-tab" tabindex="0">
                        <ul class="list-group list-group-flush followstotalcontainer" id="followstotalcontainer"></ul>
                    </div>
                </div>
            </div>
            <div class="card mb-3">
                <div class="card-header">
                    <ul class="nav nav-tabs card-header-tabs" id="gifter-lists" role="tablist">
                        <li class="nav-item">
                            <button class="nav-link active" id="gifter-tab" data-bs-toggle="tab" data-bs-target="#gifter-tab-pane" type="button" role="tab" aria-controls="gifter-tab-pane" aria-selected="true">Gifter Totals</button>
                        </li>
                        <li class="nav-item mx-auto">
                            <button class="btn btn-sm btn-outline-primary float-end" id="copy-table" type="button">Copy</button>
                            <!--&nbsp;&nbsp;
                            <button class="btn btn-sm btn-outline-primary float-end" id="sendToGS" type="button">Send 2 GS</button> -->
                        </li>
                    </ul>
                </div>
                <div class="tab-content overflow-auto" id="myTabContent" style="max-height:32vh;height:32vh;">
                    <div class="tab-pane fade show active" id="gifter-tab-pane" role="tabpanel" aria-labelledby="gifter-tab" tabindex="0">
                        <div class="table-responsive overflow-auto" style="max-height:30vh;height:30vh;">
                            <textarea id="hidden" class="d-none"></textarea>
                            <table id="gifter-table" class="table-sort table table-dark table-striped table-hover table-sm">
                                <thead>
                                    <tr>
                                        <th class="col-5 text-break">Username</th>
                                        <th class="col-5 text-break">Nickname</th>
                                        <th class="col-2 text-break">Coins Sent</th>
                                        <th class="d-none save">userId</th>
                                        <th class="d-none">likes</th>
                                    </tr>
                                </thead>
                                <tbody id="gifter-tbody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="userSettings" tabindex="-1" aria-labelledby="userSettingsLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="userSettingsLabel">Settings</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <nav>
                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="#"
                            id="name-tab" data-bs-toggle="tab" data-bs-target="#name-tab-pane"
                            type="button" role="tab" aria-controls="name-tab-pane"
                            aria-selected="true">Prefilled Names</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#"
                            id="gift-tab" data-bs-toggle="tab" data-bs-target="#gift-tab-pane"
                            type="button" role="tab" aria-controls="gift-tab-pane"
                            aria-selected="true">Gift Sounds</a>
                        </li>
                    </ul>
                </nav>
                <div class="tab-content" id="myTabContent">
                    <div class="tab-pane fade show active" id="name-tab-pane"
                    role="tabpanel" aria-labelledby="name-tab" tabindex="0">
                        <div class="input-group mt-3 mb-3">
                            <span class="input-group-text" id="basic-addon1">@</span>
                            <input type="text" class="form-control" placeholder="Username" aria-label="Username" aria-describedby="add-username" id="new-username">
                            <button class="btn btn-outline-secondary" type="button" id="add-username">Add Username</button>
                        </div>
                        <ul class="list-group" id="name-list">
                        </ul>
                    </div>
                    <div class="tab-pane fade" id="gift-tab-pane" role="tabpanel"
                    aria-labelledby="gift-tab" tabindex="0">
                        <ul class="list-group" id="gift-list">
                        </ul>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>